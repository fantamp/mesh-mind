# Спека 05: Очистка Зависимостей и Финальная Верификация

## Цель
Очистить зависимости проекта, проверить `.gitignore` и провести финальную верификацию работоспособности.

## Очистка зависимостей

### 1. Обновить requirements.txt
**Удалить зависимости:**
- `chromadb` (удалено в Спеке 01)
- `streamlit` (удалено в Спеке 02)
- `fastapi` (удалено в Спеке 03)
- `uvicorn` (удалено в Спеке 03)
- `typer` (удалено в Спеке 02)
- `tqdm` (удалено в Спеке 02)
- Другие зависимости, которые использовались только в удалённых компонентах

**Оставить обязательные:**
- `python-telegram-bot[job-queue]` (для Telegram бота)
- `google-genai` (для Google ADK)
- `sqlite3` (встроен в Python, явно не указывать)
- Зависимости для транскрипции голосовых сообщений (если используются)
- Зависимости для тестирования (`pytest`, `pytest-asyncio`, и т.д.)

### 2. Проверить импорты
- Проверить, что в коде нет импортов удалённых библиотек
- Использовать `grep -r "import chromadb" .` и аналогичные команды
- Если найдены - удалить

## Ревизия .gitignore

### 3. Проверить .gitignore
**Удалить/обновить записи для:**
- `ai_core/ui/` (удалено)
- `cli/` (удалено)
- `ai_core/api/` (удалено)
- `data/vector_store/` (удалено)

**Оставить:**
- `data/db/` (SQLite)
- `data/media/` (медиа файлы)
- `.env` (секреты)
- `venv/`, `__pycache__/`, `*.pyc` (стандартные для Python)

## Финальная верификация

### 4. Запуск тестов
```bash
make test
```
- Все тесты должны пройти успешно
- Не должно быть ошибок импорта
- Не должно быть ссылок на удалённые компоненты

### 5. Проверка запуска бота
```bash
make run-bot
```
- Бот должен успешно запуститься
- Проверить команды `/start` и `/help`
- Проверить сохранение сообщений в SQLite
- Проверить работу с Orchestrator

### 6. Проверка структуры проекта
**Убедиться, что удалены:**
- `ai_core/rag/`
- `ai_core/agents/qa/`
- `ai_core/ui/`
- `ai_core/api/`
- `cli/`
- `telegram_bot/api_client.py`

**Убедиться, что существуют:**
- `telegram_bot/handlers.py` (обновлённый)
- `telegram_bot/main.py`
- `ai_core/agents/orchestrator/`
- `ai_core/agents/chat_observer/` (с функциональностью QA)
- `ai_core/agents/summarizer/`
- `ai_core/storage/db.py`

## Обновление тестов
- Убедиться, что удалены тесты для несуществующих компонентов
- Добавить тесты для новой функциональности `chat_observer` (если требуется)

## Обновление документации
- Проверить, что все документы в `docs/` обновлены согласно спекам 01-03
- Проверить, что `.agent/rules/` обновлены согласно спеке 04

# Workflow: Проверка Перед Коммитом

Этот workflow помогает проверить изменения перед отправкой коммита в GitHub.

## Цель

Найти потенциальные проблемы в коде:
- Избыточный многословный код
- Нарушения архитектурных требований
- Грубые нарушения архитектурных паттернов
- Несоответствия продуктовым требованиям

## Входные Данные

- Diff изменений (Pull Request или локальные изменения)
- Документация проекта из `docs/`

## Шаги Выполнения

### 1. Просмотр Изменений

Изучи diff изменений:
```bash
git diff
```

### 2. Сверка с Архитектурой

Проверь соответствие архитектурным требованиям из:
- docs/architecture/system-overview.md
- docs/architecture/multi-agent-design.md
- .agent/rules/02-architecture.md

**Вопросы для проверки:**
- Соблюдены ли границы компонентов?
- Используются ли правильные паттерны (Sub-Agents, AgentTool)?
- Нет ли нарушений изоляции по chat_id?

### 3. Сверка с Продуктовыми Требованиями

Проверь соответствие продуктовой логике из:
- docs/requirements/product-vision.md
- docs/requirements/multi-agent-system.md

**Вопросы для проверки:**
- Соответствует ли реализация продуктовым требованиям?
- Не нарушена ли логика работы агентов?

### 4. Проверка Качества Кода

**Найди:**
- Избыточный многословный код → предложи упрощение
- Legacy код или неиспользуемые зависимости
- Дублирование логики

### 5. Проверка Безопасности

**Убедись:**
- Нет API ключей или секретов в коде
- `.env` используется для конфиденциальных данных
- `.gitignore` актуален

### 6. Проверка Тестов

**Убедись:**
- Для новой функциональности созданы тесты
- Тесты проходят (`pytest`, `adk eval`)

## Формат Результата

Сформулируй задачи для устранения нарушений:

**Формат:**
- Краткий маркированный список
- Максимум 140 символов на пункт

**Пример:**
- ❌ Нарушение: Orchestrator не использует sub_agents pattern
- ✅ Исправить: добавить sub_agents=[] в конфигурацию Orchestrator
- ❌ Legacy: неиспользуемый импорт google.generativeai в qa/agent.py
- ✅ Удалить: убрать импорт и зависимость

## Автоматизация

Этот workflow можно запустить вручную или интегрировать в pre-commit hook:

```bash
# Пример использования
git diff > /tmp/changes.diff
# Передать diff для проверки агенту
```

## Ссылки

> Пути относительно корня проекта

- docs/architecture/
- docs/requirements/
- docs/antigravity-rules-reglament.md

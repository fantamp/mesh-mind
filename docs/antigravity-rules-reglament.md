# Регламент по правилам и документации для Google Antigravity

## 0. Обязательные материалы к изучению

Перед любыми изменениями правил агентов обязательно:

1. Прочитай официальные материалы по Antigravity:
   - Главная страница и документация:  
     [Google Antigravity](https://antigravity.google/)
   - Блог-пост о платформе и архитектуре:  
     [Build with Google Antigravity, our new agentic development platform](https://developers.googleblog.com/en/build-with-google-antigravity-our-new-agentic-development-platform/)

2. Изучи пример рабочего workspace:
   - Antigravity Workspace Template (структура .antigravity, .cursorrules, artifacts):  
     [antigravity-workspace-template](https://github.com/study8677/antigravity-workspace-template)

3. Пойми как Antigravity наследует механизмы Gemini CLI:
   - Кастомизация через GEMINI.md и настройки CLI:  
     [Gemini CLI codelab](https://codelabs.developers.google.com/gemini-cli-hands-on)
   - Статья о системных инструкциях и GEMINI_SYSTEM_MD:  
     [Practical Gemini CLI: Bring your own system instruction](https://medium.com/google-cloud/practical-gemini-cli-bring-your-own-system-instruction-19ea7f07faa2)

После прочтения этих материалов следуй правилам ниже.

---

## 1. Уровни правил

В Antigravity отличаем три основных уровня:

1. Глобальный уровень пользователя
   - Файл: `~/.gemini/GEMINI.md`
   - Сюда попадают:
     - личные предпочтения по стилю общения и кода
     - общие инженерные принципы и стоп-линии
     - правила, которые подходят для всех проектов

2. Уровень workspace / проекта
   - `.agent/rules/*.md` для тематически разбитых правил
   - `.agent/workflows/*.md` для реюзабельных сценариев (prompt workflows)

   Здесь описываются:
   - особенности именно этого репозитория
   - архитектурные решения и соглашения по структуре кода
   - правила по тестам, миграциям, работе с артефактами

3. Документация проекта
   - Каталоги вроде `docs/`, `specs/`
   - Содержат:
     - продуктовые требования (product requirements)
     - технические спецификации (tech specs, API контракты)
     - ADR и детальный контекст домена

---

## 2. Что класть в правила, а что в требования

В файлах правил (`GEMINI.md`, `.agent/rules/*.md`) держим только то, что:

- редко меняется
- задаёт способ работы агента
- определяет безопасные и архитектурные границы

Примеры содержимого правил:
- общие инженерные принципы
- код-стайл и формат ответов
- политика по git и БД
- краткое описание домена и целей проекта
- указание где лежат детальные требования и документация

Не кладём в правила:
- полноценные product PRD
- длинные технические спецификации
- большие описания бизнес-логики

Вместо этого:
- выносим подробности в `docs/*`
- в правилах оставляем короткое резюме и ссылки на источники:
  - «Подробные требования к Feature X смотри в docs/feature-x/requirements.md. При работе над задачами по Feature X придерживайся этих требований.»

---

## 3. Структура файлов и организация правил

Рекомендуемая базовая структура:

```text
~/.gemini/
  GEMINI.md             глобальные правила и предпочтения (макс. 20 строк)
  settings.json         общие настройки CLI и инструментов

<project-root>/
  .agent/
    rules/
      01-project-overview.md    (макс. 400 строк)
      02-architecture.md        (макс. 400 строк)
      03-code-style.md          (макс. 50 строк)
      04-testing.md             (макс. 400 строк)
      05-safety.md              (макс. 50 строк)
    workflows/
      generate-tests.md         (макс. 200 строк)
      implement-from-spec.md    (макс. 200 строк)
  docs/
    requirements/               (макс. 600 строк на файл)
    architecture/               (макс. 600 строк на файл)
    api/                        (макс. 600 строк на файл)
```

---

## 4. Лимиты по длине файлов

Для поддержания краткости и читаемости документации установлены следующие лимиты:

### Глобальные правила пользователя
- `~/.gemini/GEMINI.md`: **максимум 20 строк**
- Только самое важное и универсальное для всех проектов

### Правила workspace (`.agent/rules/`)
- Стандартные правила: **максимум 400 строк** на файл
- Краткие правила (code-style, safety): **максимум 50 строк** на файл
- Цель: краткость, четкость, быстрая читаемость агентами

### Workflows (`.agent/workflows/`)
- **Максимум 200 строк** на файл
- Короткие, четкие инструкции для выполнения

### Документация проекта (`docs/`)
- **Максимум 600 строк** на файл
- Детальное описание без избыточности
- Если файл превышает лимит, разбить на несколько файлов

### Корневые указатели
- `AGENTS.md`: **максимум 100 строк**
- Краткий навигатор по правилам и документации

**Принцип:** Если не укладываешься в лимит — разбей на несколько файлов или убери избыточность.

---
# Maintenance Agent

## Overview
Агент для выполнения административных задач и обслуживания бота на сервере (DevOps).

## Problem Statement
Ручное обновление и обслуживание бота на удаленном сервере неудобно, требует переключения контекста (ssh, ввод команд) и отнимает время.

## Solution Statement
Специализированный агент с набором безопасных высокоуровневых инструментов (например, `update_codebase`, `restart_application`, `get_logs`) вместо предоставления прямого доступа к shell.

## Value Statement
1. **Удобство:** Обновление и перезапуск сервиса одной командой прямо из чата.
2. **Безопасность:** Использование ограниченного набора проверенных команд вместо произвольного выполнения shell-скриптов.
3. **Оперативность:** Быстрый доступ к логам и диагностике проблем.

## Architecture / Technical details
- **Иерархия:** Отдельный агент, подчиняющийся Оркестратору.
- **Инструменты:**
    - Реализованы как изолированные функции в отдельных файлах (для удобства тестирования).
    - Строго типизированные действия: `git pull`, `restart`, `tail logs`, `check version`.
- **Безопасность:**
    - Детекция среды (Prod/Dev). На локальной машине разработчика деструктивные команды блокируются или мокаются.
    - Проверка результата `git pull` (конфликты мерджа) перед попыткой рестарта.
- **Deployment:** Учет работы под `tmux` (см. `make bot-tmux`) для корректного перезапуска процесса. Создание bash-скрипта для запуска агента под `tmux`.
- **UX:** Уведомление в админский чат после успешного перезапуска ("Я обновился и снова жив").
